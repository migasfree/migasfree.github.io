import{_ as l}from"./plugin-vue_export-helper-c27b6911.js";import{r as o,o as c,c as d,b as a,d as e,a as n,w as r,e as p,i}from"./app-62475e9b.js";const u={},m=a("code",null,"MIGASFREE_REMOTE_ADMIN_LINK",-1),v=i(`<p>En el siguiente art칤culo vamos a sacarle m치s funcionalidades a este par치metro de configuraci칩n y a narrar c칩mo configurar nuestro entorno (se entender치 que es una m치quina con Linux) para obtener un acceso directo a los protocolos desde el navegador (Firefox, Chrome/Chromium).</p><h2 id="en-el-servidor-migasfree" tabindex="-1"><a class="header-anchor" href="#en-el-servidor-migasfree" aria-hidden="true">#</a> En el servidor migasfree</h2><p>Para comenzar, tendremos que configurar adecuadamente el par치metro en el archivo <code>/etc/migasfree-server/settings.py</code> de nuestro servidor migasfree. Un ejemplo, podr칤a ser el siguiente:</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>MIGASFREE_REMOTE_ADMIN_LINK <span class="token operator">=</span> <span class="token string">&quot;mvnc://{{computer.ip}} mping://{{computer.ip}} mssh://root@{{computer.ip}} mupdate://root@{{computer.ip}}&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Para que los protocolos sean 춺personalizados췉 y no causen conflictos con otros que pueden tener otra configuraci칩n en los sistemas, he preferido anteponerles la letra 춺m췉 (de migasfree 游땔).</p><p>Tras realizar los cambios, deberemos hacer que el servidor web relea la configuraci칩n para que se apliquen dichos cambios.</p><p>Como se comenta en el libro, despu칠s de activar este par치metro, cada vez que se represente un ordenador en la aplicaci칩n web de migasfree, tendremos disponibles nuevas acciones que vendr치n indicadas por los nombres de los protocolos. Siguiendo el ejemplo ser칤an: <code>mvnc</code>, <code>mping</code>, <code>mssh</code> y <code>mupdate</code>. Eso s칤, por mucho que pulsemos sobre ellos en el interfaz, no van a realizar todav칤a ninguna acci칩n, ya que todav칤a falta por configurar la parte cliente (nuestra estaci칩n de trabajo que se conecta al servidor), para obtener las funcionalidades perseguidas.</p><h2 id="en-nuestro-ordenador-cliente" tabindex="-1"><a class="header-anchor" href="#en-nuestro-ordenador-cliente" aria-hidden="true">#</a> En nuestro ordenador cliente</h2><p>Creamos en primer lugar el fichero <code>/usr/bin/migasfree-protocols</code>, con el siguiente contenido:</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token shebang important">#!/bin/bash</span>

<span class="token assign-left variable">_PROTOCOL</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> $1 <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">&#39;BEGIN {FS = &quot;://&quot;}; {print $1}&#39;</span><span class="token variable">)</span></span>
<span class="token assign-left variable">_URL</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> $1 <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">&#39;BEGIN {FS = &quot;://&quot;}; {print $2}&#39;</span><span class="token variable">)</span></span>

<span class="token keyword">case</span> <span class="token string">&quot;<span class="token variable">$_PROTOCOL</span>&quot;</span> <span class="token keyword">in</span>
    <span class="token string">&quot;mssh&quot;</span><span class="token punctuation">)</span>
        gnome-terminal <span class="token parameter variable">--command</span> <span class="token string">&quot;ssh <span class="token variable">$_URL</span>&quot;</span>
        <span class="token punctuation">;</span><span class="token punctuation">;</span>

    <span class="token string">&quot;mvnc&quot;</span><span class="token punctuation">)</span>
        vncviewer <span class="token variable">$_URL</span>
        <span class="token punctuation">;</span><span class="token punctuation">;</span>

    <span class="token string">&quot;mping&quot;</span><span class="token punctuation">)</span>
        gnome-terminal <span class="token parameter variable">--command</span> <span class="token string">&quot;ping <span class="token variable">$_URL</span>&quot;</span>
        <span class="token punctuation">;</span><span class="token punctuation">;</span>

    <span class="token string">&quot;mupdate&quot;</span><span class="token punctuation">)</span>
        gnome-terminal <span class="token parameter variable">--command</span> <span class="token string">&quot;ssh <span class="token variable">$_URL</span> migasfree --update; echo; echo TERMINADO; read&quot;</span>
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">esac</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>En este fichero, que deber치 tener permisos de ejecuci칩n, se describe qu칠 hacer con cada uno de los protocolos. En este ejemplo son necesarias las utilidades <code>ssh</code> y <code>vncviewer</code>, pero se podr칤an cambiar por otras (al igual que <code>gnome-terminal</code>), dependiendo de nuestra distribuci칩n Linux.</p><p>Ahora s칩lo falta decirle al navegador qu칠 debe hacer cuando se encuentre con los protocolos. El proceso va a diferir seg칰n el navegador web que usemos.</p><h3 id="chrome-chromium" tabindex="-1"><a class="header-anchor" href="#chrome-chromium" aria-hidden="true">#</a> Chrome/Chromium</h3><p>Tenemos que configurar la asociaci칩n de protocolos a nivel de entorno gr치fico. Para ello, crearemos el fichero <code>/usr/share/applications/migasfree-protocols.desktop</code>:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>[Desktop Entry]
Encoding=UTF-8
Type=Application
Name=migasfree protocols
Exec=/usr/bin/migasfree-protocols %U
Terminal=false
MimeType=x-scheme-handler/mssh;x-scheme-handler/mvnc;x-scheme-handler/mping;x-scheme-handler/mupdate;
NoDisplay=true
StartupNotify=true
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,15),b={href:"https://help.ubuntu.com/community/AddingMimeTypes",target:"_blank",rel:"noopener noreferrer"},h=a("code",null,"NoDisplay=true",-1),g=i(`<p>Despu칠s, s칩lo queda actualizar la base de datos de lanzadores y <em>mimetypes</em> mediante los comandos (con un usuario con privilegios de root):</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>update-desktop-database
update-mime-database /usr/share/mime
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="firefox" tabindex="-1"><a class="header-anchor" href="#firefox" aria-hidden="true">#</a> Firefox</h3><p>Para este navegador, adem치s del paso anterior, tendremos que crear el fichero <code>/usr/lib/firefox/defaults/pref/migasfree.js</code> con este contenido:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>pref(&quot;network.protocol-handler.expose.mssh&quot;, false);
pref(&quot;network.protocol-handler.expose.mvnc&quot;, false);
pref(&quot;network.protocol-handler.expose.mping&quot;, false);
pref(&quot;network.protocol-handler.expose.mupdate&quot;, false);

pref(&quot;network.protocol-handler.app.mssh&quot;, &quot;/usr/bin/migasfree-protocols&quot;);
pref(&quot;network.protocol-handler.app.mvnc&quot;, &quot;/usr/bin/migasfree-protocols&quot;);
pref(&quot;network.protocol-handler.app.mping&quot;, &quot;/usr/bin/migasfree-protocols&quot;);
pref(&quot;network.protocol-handler.app.mupdate&quot;, &quot;/usr/bin/migasfree-protocols&quot;);

pref(&quot;network.protocol-handler.warn-external.mssh&quot;, false);
pref(&quot;network.protocol-handler.warn-external.mvnc&quot;, false);
pref(&quot;network.protocol-handler.warn-external.mping&quot;, false);
pref(&quot;network.protocol-handler.warn-external.mupdate&quot;, false);

pref(&quot;network.protocol-handler.external.mssh&quot;, true);
pref(&quot;network.protocol-handler.external.mvnc&quot;, true);
pref(&quot;network.protocol-handler.external.mping&quot;, true);
pref(&quot;network.protocol-handler.external.mupdate&quot;, true);
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Y una vez que volvamos a iniciar el navegador ya tendremos disponible el comportamiento esperado.</p><h2 id="corolario" tabindex="-1"><a class="header-anchor" href="#corolario" aria-hidden="true">#</a> Corolario</h2><p>Como puede verse, las posibilidades son amplias y van a depender de nuestro entorno particular para adecuarlo a unas necesidades determinadas. Es por ello que desde el proyecto migasfree no se ha creado un paquete gen칠rico para cubrir esta funcionalidad.</p><p>Se deja como ejercicio pr치ctico para cada organizaci칩n el crear un paquete a medida con los protocolos que all칤 se consideren pr치cticos y realizar la configuraci칩n adecuada para sus entornos de explotaci칩n (navegadores) de la aplicaci칩n web de migasfree.</p><h2 id="actualizacion-2018-03-02" tabindex="-1"><a class="header-anchor" href="#actualizacion-2018-03-02" aria-hidden="true">#</a> Actualizaci칩n (2018-03-02)</h2><p>A partir de la versi칩n <code>4.14</code> del servidor migasfree, el par치metro <code>MIGASFREE_REMOTE_ADMIN_LINK</code> se convierte en lista:</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>MIGASFREE_REMOTE_ADMIN_LINK <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;mvnc://{{computer.ip}}&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;mping://{{computer.ip}}&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;mssh://root@{{computer.ip}}&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;mupdate://root@{{computer.ip}}&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,12);function f(q,k){const s=o("acronym"),t=o("ExternalLinkIcon");return c(),d("div",null,[a("p",null,[e("En la documentaci칩n del proyecto, se menciona de pasada el par치metro "),m,e(", describiendo brevemente c칩mo configurar el acceso por "),n(s,{title:"Virtual Network Computing"},{default:r(()=>[e("VNC")]),_:1}),e(" y "),n(s,{title:"Secure Shell"},{default:r(()=>[e("SSH")]),_:1}),e(" a los equipos, pero sin explicar c칩mo conseguir que esos protocolos sean accesibles directamente desde nuestro navegador web.")]),p(" more "),v,a("p",null,[e("Como este lanzador s칩lo tiene fines de asociaci칩n de "),a("a",b,[e("MimeTypes"),n(t)]),e(", no se mostrar치 en el men칰 de aplicaciones ("),h,e("), por lo que no es necesario que tenga asociado un icono o las categor칤as definidas.")]),g])}const w=l(u,[["render",f],["__file","2016-03-16-acceso-remoto-ordenadores.html.vue"]]);export{w as default};
